{"version":3,"file":"indexRollup.js","sources":["src/legend.js","src/color.js","src/size.js","src/symbol.js","src/helpers.js","index.js"],"sourcesContent":["import { select } from 'd3-selection'\nimport { format, formatPrefix } from 'd3-format'\n\nconst d3_identity =  (d) => d\n\nconst d3_reverse = (arr) => {\n  const mirror = [];\n  for (let i = 0, l = arr.length; i < l; i++) {\n    mirror[i] = arr[l-i-1];\n  }\n  return mirror;\n}\n\n//Text wrapping code adapted from Mike Bostock\nconst d3_textWrapping = (text, width) => {\n  text.each(function() {\n    var text = select(this),\n        words = text.text().split(/\\s+/).reverse(),\n        word,\n        line = [],\n        lineNumber = 0,\n        lineHeight = 1.2, //ems\n        y = text.attr(\"y\"),\n        dy = parseFloat(text.attr(\"dy\")) || 0,\n        tspan = text.text(null)\n          .append(\"tspan\")\n          .attr(\"x\", 0)\n          .attr(\"dy\", dy + \"em\");\n\n    while (word = words.pop()) {\n      line.push(word);\n      tspan.text(line.join(\" \"));\n      if (tspan.node().getComputedTextLength() > width && line.length > 1) {\n        line.pop();\n        tspan.text(line.join(\" \"));\n        line = [word];\n        tspan = text.append(\"tspan\")\n          .attr(\"x\", 0)\n          .attr(\"dy\", lineHeight + dy + \"em\").text(word);\n      }\n    }\n  });\n}\n\n\nconst d3_mergeLabels = (gen=[], labels, domain, range) => {\n\n    if (typeof labels === \"object\"){\n      if(labels.length === 0) return gen;\n\n      let i = labels.length;\n      for (; i < gen.length; i++) {\n        labels.push(gen[i]);\n      }\n      return labels;\n    } else if (typeof labels === \"function\") {\n      const customLabels = []\n      const genLength = gen.length\n      for (let i=0; i < genLength; i++){\n        customLabels.push(labels({\n          i,\n          genLength,\n          generatedLabels : gen,\n          domain,\n          range }))\n      }\n      return customLabels\n    }\n\n    return gen;\n  }\n\nconst d3_linearLegend = (scale, cells, labelFormat) => {\n  let data = [];\n\n  if (cells.length > 1){\n    data = cells;\n\n  } else {\n    const domain = scale.domain(),\n    increment = (domain[domain.length - 1] - domain[0])/(cells - 1)\n    let i = 0;\n\n    for (; i < cells; i++){\n      data.push(domain[0] + i*increment);\n    }\n  }\n\n  const labels = data.map(labelFormat);\n  return {data: data,\n          labels: labels,\n          feature: d => scale(d)};\n}\n\nconst d3_quantLegend = (scale, labelFormat, labelDelimiter) => {\n  const labels = scale.range().map( d => {\n    const invert = scale.invertExtent(d);\n    return labelFormat(invert[0]) + \" \" + labelDelimiter + \" \" + labelFormat(invert[1]);\n  });\n\n  return {data: scale.range(),\n          labels: labels,\n          feature: d3_identity\n        };\n}\n\nconst d3_ordinalLegend= scale => ({data: scale.domain(),\n          labels: scale.domain(),\n          feature: d => scale(d) }\n)\n\nconst d3_cellOver = (cellDispatcher, d, obj) => {\n  cellDispatcher.call(\"cellover\", obj, d);\n}\n\nconst d3_cellOut = (cellDispatcher, d, obj) => {\n  cellDispatcher.call(\"cellout\", obj, d);\n}\n\nconst d3_cellClick = (cellDispatcher, d, obj) => {\n  cellDispatcher.call(\"cellclick\", obj, d);\n}\n\n\nexport default {\n\n  d3_drawShapes: (shape, shapes, shapeHeight, shapeWidth, shapeRadius, path) => {\n    if (shape === \"rect\"){\n        shapes.attr(\"height\", shapeHeight)\n        .attr(\"width\", shapeWidth);\n\n    } else if (shape === \"circle\") {\n        shapes.attr(\"r\", shapeRadius)\n\n    } else if (shape === \"line\") {\n        shapes.attr(\"x1\", 0).attr(\"x2\", shapeWidth).attr(\"y1\", 0).attr(\"y2\", 0);\n\n    } else if (shape === \"path\") {\n      shapes.attr(\"d\", path);\n    }\n  },\n\n  d3_addText: function (svg, enter, labels, classPrefix, labelWidth){\n    enter.append(\"text\").attr(\"class\", classPrefix + \"label\");\n    const text = svg.selectAll(`g.${classPrefix}cell text.${classPrefix}label`)\n      .data(labels)\n      .text(d3_identity);\n\n    if (labelWidth){\n      svg.selectAll(`g.${classPrefix}cell text.${classPrefix}label`)\n          .call(d3_textWrapping, labelWidth)\n    }\n\n    return text\n  },\n\n  d3_calcType: function (scale, ascending, cells, labels, labelFormat, labelDelimiter){\n    const type = scale.invertExtent ?\n            d3_quantLegend(scale, labelFormat, labelDelimiter) : scale.ticks ?\n            d3_linearLegend(scale, cells, labelFormat) : d3_ordinalLegend(scale);\n\n    //for d3.scaleSequential that doesn't have a range function\n    const range = scale.range && scale.range() || scale.domain()\n    type.labels = d3_mergeLabels(type.labels, labels, scale.domain(), range);\n\n    if (ascending) {\n      type.labels = d3_reverse(type.labels);\n      type.data = d3_reverse(type.data);\n    }\n\n    return type;\n  },\n\n  d3_filterCells: (type, cellFilter) => {\n    let filterCells = type.data.map((d, i) => ({ data: d, label: type.labels[i] }))\n      .filter(cellFilter)\n    const dataValues = filterCells.map(d => d.data)\n    const labelValues = filterCells.map(d => d.label)\n    type.data = type.data.filter(d => dataValues.indexOf(d) !== -1)\n    type.labels = type.labels.filter(d => labelValues.indexOf(d) !== -1)\n    return type\n  },\n\n  d3_placement: (orient, cell, cellTrans, text, textTrans, labelAlign) => {\n    cell.attr(\"transform\", cellTrans);\n    text.attr(\"transform\", textTrans);\n    if (orient === \"horizontal\"){\n      text.style(\"text-anchor\", labelAlign);\n    }\n  },\n\n  d3_addEvents: function(cells, dispatcher){\n      cells.on(\"mouseover.legend\", function (d) { d3_cellOver(dispatcher, d, this); })\n          .on(\"mouseout.legend\", function (d) { d3_cellOut(dispatcher, d, this); })\n          .on(\"click.legend\", function (d) { d3_cellClick(dispatcher, d, this); });\n  },\n\n  d3_title: (svg, title, classPrefix, titleWidth) => {\n    if (title !== \"\"){\n\n      const titleText = svg.selectAll('text.' + classPrefix + 'legendTitle');\n\n      titleText.data([title])\n        .enter()\n        .append('text')\n        .attr('class', classPrefix + 'legendTitle');\n\n      svg.selectAll('text.' + classPrefix + 'legendTitle')\n        .text(title)\n\n      if (titleWidth){\n        svg.selectAll('text.' + classPrefix + 'legendTitle')\n          .call(d3_textWrapping, titleWidth)\n      }\n\n      const cellsSvg = svg.select('.' + classPrefix + 'legendCells')\n      const yOffset = svg.select('.' + classPrefix + 'legendTitle').nodes()\n          .map(d => d.getBBox().height)[0],\n\n      xOffset = -cellsSvg.nodes().map(function(d) { return d.getBBox().x})[0];\n      cellsSvg.attr('transform', 'translate(' + xOffset + ',' + (yOffset) + ')');\n\n    }\n  },\n\n  d3_defaultLocale: {\n    format,\n    formatPrefix\n  },\n\n  d3_defaultFormatSpecifier: '.01f',\n\n  d3_defaultDelimiter: 'to'\n}\n","import helper from './legend';\nimport { dispatch } from 'd3-dispatch';\nimport { scaleLinear } from 'd3-scale';\nimport { formatLocale, formatSpecifier } from 'd3-format';\n\nimport { sum } from 'd3-array';\n\nexport default function color(){\n\n  let scale = scaleLinear(),\n    shape = \"rect\",\n    shapeWidth = 15,\n    shapeHeight = 15,\n    shapeRadius = 10,\n    shapePadding = 2,\n    cells = [5],\n    cellFilter,\n    labels = [],\n    classPrefix = \"\",\n    useClass = false,\n    title = \"\",\n    locale = helper.d3_defaultLocale,\n    specifier = helper.d3_defaultFormatSpecifier,\n    labelOffset = 10,\n    labelAlign = \"middle\",\n    labelDelimiter = helper.d3_defaultDelimiter,\n    labelWrap,\n    orient = \"vertical\",\n    ascending = false,\n    path,\n    titleWidth,\n    legendDispatcher = dispatch(\"cellover\", \"cellout\", \"cellclick\");\n\n  function legend(svg) {\n\n      const type = helper.d3_calcType(scale, ascending, cells, labels, locale.format(specifier), labelDelimiter),\n        legendG = svg.selectAll('g').data([scale]);\n\n      legendG.enter().append('g').attr('class', classPrefix + 'legendCells');\n\n      if (cellFilter){\n        helper.d3_filterCells(type, cellFilter)\n      }\n\n      let cell = svg.select('.' + classPrefix + 'legendCells')\n          .selectAll(\".\" + classPrefix + \"cell\").data(type.data)\n\n      const cellEnter = cell.enter().append(\"g\")\n          .attr(\"class\", classPrefix + \"cell\")\n      cellEnter.append(shape).attr(\"class\", classPrefix + \"swatch\")\n\n      let shapes = svg.selectAll(\"g.\" + classPrefix + \"cell \" + shape).data(type.data);\n\n      //add event handlers\n      helper.d3_addEvents(cellEnter, legendDispatcher);\n\n      cell.exit().transition().style(\"opacity\", 0).remove();\n      shapes.exit().transition().style(\"opacity\", 0).remove();\n\n      shapes = shapes.merge(shapes);\n\n      helper.d3_drawShapes(shape, shapes, shapeHeight, shapeWidth, shapeRadius, path);\n      helper.d3_addText( svg, cellEnter, type.labels, classPrefix, labelWrap)\n\n      // we need to merge the selection, otherwise changes in the legend (e.g. change of orientation) are applied only to the new cells and not the existing ones.\n      cell = cellEnter.merge(cell);\n\n      // sets placement\n      const text = cell.selectAll(\"text\"),\n        textSize = text.nodes().map(d => d.getBBox()),\n        shapeSize = shapes.nodes().map( d => d.getBBox());\n      //sets scale\n      //everything is fill except for line which is stroke,\n      if (!useClass){\n        if (shape == \"line\"){\n          shapes.style(\"stroke\", type.feature);\n        } else {\n          shapes.style(\"fill\", type.feature);\n        }\n      } else {\n        shapes.attr(\"class\", d => `${classPrefix}swatch ${type.feature(d)}`);\n      }\n\n      let cellTrans,\n      textTrans,\n      textAlign = (labelAlign == \"start\") ? 0 : (labelAlign == \"middle\") ? 0.5 : 1;\n\n      //positions cells and text\n      if (orient === \"vertical\"){\n        const cellSize = textSize.map((d, i) => Math.max(d.height, shapeSize[i].height))\n\n        cellTrans = (d, i) => {\n          const height = sum(cellSize.slice(0, i));\n          return `translate(0, ${height + i*shapePadding})`}\n\n        textTrans = (d,i) => `translate( ${(shapeSize[i].width + shapeSize[i].x +\n          labelOffset)}, ${(shapeSize[i].y + shapeSize[i].height/2 + 5)})`;\n\n      } else if (orient === \"horizontal\"){\n        cellTrans = (d,i) => `translate(${(i * (shapeSize[i].width + shapePadding))},0)`\n        textTrans = (d,i) => `translate(${(shapeSize[i].width*textAlign  + shapeSize[i].x)},\n          ${(shapeSize[i].height + shapeSize[i].y + labelOffset + 8)})`;\n      } else if (orient === \"horizontal-inline\"){\n        let prevCellSizes = (i) => cell.filter((d, ci) => ci < i ).nodes().reduce((acc, n, ci) => {\n          const shapeWidth = shapeSize[i].width + shapePadding\n          const textWidth = text.nodes()[ci].getBBox().width + labelOffset\n          return acc + shapeWidth + textWidth\n        }, 0)\n        cellTrans = (d,i) => `translate(${prevCellSizes(i)},0)`\n        textTrans = (d,i) => `translate(${(shapeSize[i].width + shapeSize[i].x + labelOffset)}, \n          ${(shapeSize[i].y + shapeSize[i].height/2 + 5)})`\n      }\n\n      helper.d3_placement(orient, cell, cellTrans, text, textTrans, labelAlign);\n      helper.d3_title(svg, title, classPrefix, titleWidth);\n\n      cell.transition().style(\"opacity\", 1);\n\n  }\n\n  legend.scale = function(_) {\n    if (!arguments.length) return scale;\n    scale = _;\n    return legend;\n  };\n\n  legend.cells = function(_) {\n    if (!arguments.length) return cells;\n    if (_.length > 1 || _ >= 2 ){\n      cells = _;\n    }\n    return legend;\n  };\n\n  legend.cellFilter = function(_) {\n    if (!arguments.length) return cellFilter;\n    cellFilter = _;\n    return legend;\n  };\n\n  legend.shape = function(_, d) {\n    if (!arguments.length) return shape;\n    if (_ == \"rect\" || _ == \"circle\" || _ == \"line\" || (_ == \"path\" && (typeof d === 'string')) ){\n      shape = _;\n      path = d;\n    }\n    return legend;\n  };\n\n  legend.shapeWidth = function(_) {\n    if (!arguments.length) return shapeWidth;\n    shapeWidth = +_;\n    return legend;\n  };\n\n  legend.shapeHeight = function(_) {\n    if (!arguments.length) return shapeHeight;\n    shapeHeight = +_;\n    return legend;\n  };\n\n  legend.shapeRadius = function(_) {\n    if (!arguments.length) return shapeRadius;\n    shapeRadius = +_;\n    return legend;\n  };\n\n  legend.shapePadding = function(_) {\n    if (!arguments.length) return shapePadding;\n    shapePadding = +_;\n    return legend;\n  };\n\n  legend.labels = function(_) {\n    if (!arguments.length) return labels;\n    labels = _;\n    return legend;\n  };\n\n  legend.labelAlign = function(_) {\n    if (!arguments.length) return labelAlign;\n    if (_ == \"start\" || _ == \"end\" || _ == \"middle\") {\n      labelAlign = _;\n    }\n    return legend;\n  };\n\n  legend.locale = function(_) {\n    if (!arguments.length) return locale;\n    locale = formatLocale(_)\n    return legend\n  };\n\n  legend.labelFormat = function(_) {\n    if (!arguments.length) return legend.locale().format(specifier);\n    specifier = formatSpecifier(_)\n    return legend;\n  };\n\n  legend.labelOffset = function(_) {\n    if (!arguments.length) return labelOffset;\n    labelOffset = +_;\n    return legend;\n  };\n\n  legend.labelDelimiter = function(_) {\n    if (!arguments.length) return labelDelimiter;\n    labelDelimiter = _;\n    return legend;\n  };\n\n  legend.labelWrap = function(_) {\n    if (!arguments.length) return labelWrap;\n    labelWrap = _;\n    return legend;\n  };\n\n  legend.useClass = function(_) {\n    if (!arguments.length) return useClass;\n    if (_ === true || _ === false){\n      useClass = _;\n    }\n    return legend;\n  };\n\n  legend.orient = function(_){\n    if (!arguments.length) return orient;\n    _ = _.toLowerCase();\n    if (_ == \"horizontal\" || _ == \"vertical\" || _ == \"horizontal-inline\") {\n      orient = _;\n    }\n    return legend;\n  };\n\n  legend.ascending = function(_) {\n    if (!arguments.length) return ascending;\n    ascending = !!_;\n    return legend;\n  };\n\n  legend.classPrefix = function(_) {\n    if (!arguments.length) return classPrefix;\n    classPrefix = _;\n    return legend;\n  };\n\n  legend.title = function(_) {\n    if (!arguments.length) return title;\n    title = _;\n    return legend;\n  };\n\n  legend.titleWidth = function(_) {\n    if (!arguments.length) return titleWidth;\n    titleWidth = _;\n    return legend;\n  };\n\n  legend.textWrap = function(_) {\n    if (!arguments.length) return textWrap;\n    textWrap = _;\n    return legend;\n  }\n\n  legend.on = function(){\n    const value = legendDispatcher.on.apply(legendDispatcher, arguments)\n    return value === legendDispatcher ? legend : value;\n  }\n\n  return legend;\n\n};\n","import helper from \"./legend\"\nimport { dispatch } from \"d3-dispatch\"\nimport { scaleLinear } from \"d3-scale\"\nimport { formatLocale, formatSpecifier } from \"d3-format\"\nimport { sum, max } from \"d3-array\"\n\nexport default function size() {\n  let scale = scaleLinear(),\n    shape = \"rect\",\n    shapeWidth = 15,\n    shapePadding = 2,\n    cells = [5],\n    cellFilter,\n    labels = [],\n    classPrefix = \"\",\n    title = \"\",\n    locale = helper.d3_defaultLocale,\n    specifier = helper.d3_defaultFormatSpecifier,\n    labelOffset = 10,\n    labelAlign = \"middle\",\n    labelDelimiter = helper.d3_defaultDelimiter,\n    labelWrap,\n    orient = \"vertical\",\n    ascending = false,\n    path,\n    titleWidth,\n    legendDispatcher = dispatch(\"cellover\", \"cellout\", \"cellclick\")\n\n  function legend(svg) {\n    const type = helper.d3_calcType(\n        scale,\n        ascending,\n        cells,\n        labels,\n        locale.format(specifier),\n        labelDelimiter\n      ),\n      legendG = svg.selectAll(\"g\").data([scale])\n\n    if (cellFilter) {\n      helper.d3_filterCells(type, cellFilter)\n    }\n\n    legendG\n      .enter()\n      .append(\"g\")\n      .attr(\"class\", classPrefix + \"legendCells\")\n\n    let cell = svg\n      .select(\".\" + classPrefix + \"legendCells\")\n      .selectAll(\".\" + classPrefix + \"cell\")\n      .data(type.data)\n    const cellEnter = cell\n      .enter()\n      .append(\"g\")\n      .attr(\"class\", classPrefix + \"cell\")\n    cellEnter.append(shape).attr(\"class\", classPrefix + \"swatch\")\n\n    let shapes = svg.selectAll(\"g.\" + classPrefix + \"cell \" + shape)\n\n    //add event handlers\n    helper.d3_addEvents(cellEnter, legendDispatcher)\n\n    cell\n      .exit()\n      .transition()\n      .style(\"opacity\", 0)\n      .remove()\n\n    shapes\n      .exit()\n      .transition()\n      .style(\"opacity\", 0)\n      .remove()\n    shapes = shapes.merge(shapes)\n\n    //creates shape\n    if (shape === \"line\") {\n      helper.d3_drawShapes(shape, shapes, 0, shapeWidth)\n      shapes.attr(\"stroke-width\", type.feature)\n    } else {\n      helper.d3_drawShapes(\n        shape,\n        shapes,\n        type.feature,\n        type.feature,\n        type.feature,\n        path\n      )\n    }\n\n    const text = helper.d3_addText(\n      svg,\n      cellEnter,\n      type.labels,\n      classPrefix,\n      labelWrap\n    )\n\n    // we need to merge the selection, otherwise changes in the legend (e.g. change of orientation) are applied only to the new cells and not the existing ones.\n    cell = cellEnter.merge(cell)\n\n    //sets placement\n\n    const textSize = text.nodes().map(d => d.getBBox()),\n      shapeSize = shapes.nodes().map((d, i) => {\n        const bbox = d.getBBox()\n        const stroke = scale(type.data[i])\n\n        if (shape === \"line\" && orient === \"horizontal\") {\n          bbox.height = bbox.height + stroke\n        } else if (shape === \"line\" && orient === \"vertical\") {\n          bbox.width = bbox.width\n        }\n        return bbox\n      })\n    //console.log('SHAPESIZE')\n    const maxH = max(shapeSize, d => d.height + d.y),\n      maxW = max(shapeSize, d => d.width + d.x)\n\n    let cellTrans,\n      textTrans,\n      textAlign = labelAlign == \"start\" ? 0 : labelAlign == \"middle\" ? 0.5 : 1\n\n    //positions cells and text\n    if (orient === \"vertical\") {\n      const cellSize = textSize.map((d, i) =>\n        Math.max(d.height, shapeSize[i].height)\n      )\n      const y =\n        shape == \"circle\" || shape == \"line\" ? shapeSize[0].height / 2 : 0\n      cellTrans = (d, i) => {\n        const height = sum(cellSize.slice(0, i))\n\n        return `translate(0, ${y + height + i * shapePadding})`\n      }\n\n      textTrans = (d, i) => `translate( ${maxW + labelOffset},\n          ${shapeSize[i].y + shapeSize[i].height / 2 + 5})`\n    } else if (orient === \"horizontal\") {\n      cellTrans = (d, i) => {\n        const width = sum(shapeSize.slice(0, i), d => d.width)\n        const y = shape == \"circle\" || shape == \"line\" ? maxH / 2 : 0\n        return `translate(${width + i * shapePadding}, ${y})`\n      }\n\n      const offset = shape == \"line\" ? maxH / 2 : maxH\n      textTrans = (d, i) => {\n        return `translate( ${shapeSize[i].width * textAlign + shapeSize[i].x},\n              ${offset + labelOffset})`\n      }\n    } else if (orient === \"horizontal-inline\"){\n      let prevCellSizes = (i) => cell.filter((d, ci) => ci < i ).nodes().reduce((acc, n, ci) => {\n          const shapeWidth = shapeSize[ci].width + shapePadding\n          const textWidth = text.nodes()[ci].getBBox().width + labelOffset\n          return acc + shapeWidth + textWidth;\n      }, 0)\n      cellTrans = (d,i) => `translate(${prevCellSizes(i)},0)`\n      textTrans = (d,i) => `translate(${(shapeSize[i].width + shapeSize[i].x + labelOffset)}, \n        ${(shapeSize[i].y + shapeSize[i].height/2 + 5)})`\n    }\n\n    helper.d3_placement(orient, cell, cellTrans, text, textTrans, labelAlign)\n    helper.d3_title(svg, title, classPrefix, titleWidth)\n\n    cell.transition().style(\"opacity\", 1)\n  }\n\n  legend.scale = function(_) {\n    if (!arguments.length) return scale\n    scale = _\n    return legend\n  }\n\n  legend.cells = function(_) {\n    if (!arguments.length) return cells\n    if (_.length > 1 || _ >= 2) {\n      cells = _\n    }\n    return legend\n  }\n\n  legend.cellFilter = function(_) {\n    if (!arguments.length) return cellFilter\n    cellFilter = _\n    return legend\n  }\n\n  legend.shape = function(_, d) {\n    if (!arguments.length) return shape\n    if (_ == \"rect\" || _ == \"circle\" || _ == \"line\") {\n      shape = _\n      path = d\n    }\n    return legend\n  }\n\n  legend.shapeWidth = function(_) {\n    if (!arguments.length) return shapeWidth\n    shapeWidth = +_\n    return legend\n  }\n\n  legend.shapePadding = function(_) {\n    if (!arguments.length) return shapePadding\n    shapePadding = +_\n    return legend\n  }\n\n  legend.labels = function(_) {\n    if (!arguments.length) return labels\n    labels = _\n    return legend\n  }\n\n  legend.labelAlign = function(_) {\n    if (!arguments.length) return labelAlign\n    if (_ == \"start\" || _ == \"end\" || _ == \"middle\") {\n      labelAlign = _\n    }\n    return legend\n  }\n\n  legend.locale = function(_) {\n    if (!arguments.length) return locale\n    locale = formatLocale(_)\n    return legend\n  }\n\n  legend.labelFormat = function(_) {\n    if (!arguments.length) return legend.locale().format(specifier)\n    specifier = formatSpecifier(_)\n    return legend\n  }\n\n  legend.labelOffset = function(_) {\n    if (!arguments.length) return labelOffset\n    labelOffset = +_\n    return legend\n  }\n\n  legend.labelDelimiter = function(_) {\n    if (!arguments.length) return labelDelimiter\n    labelDelimiter = _\n    return legend\n  }\n\n  legend.labelWrap = function(_) {\n    if (!arguments.length) return labelWrap\n    labelWrap = _\n    return legend\n  }\n\n  legend.orient = function(_) {\n    if (!arguments.length) return orient\n    _ = _.toLowerCase()\n    if (_ == \"horizontal\" || _ == \"vertical\" || _ == \"horizontal-inline\") {\n      orient = _\n    }\n    return legend\n  }\n\n  legend.ascending = function(_) {\n    if (!arguments.length) return ascending\n    ascending = !!_\n    return legend\n  }\n\n  legend.classPrefix = function(_) {\n    if (!arguments.length) return classPrefix\n    classPrefix = _\n    return legend\n  }\n\n  legend.title = function(_) {\n    if (!arguments.length) return title\n    title = _\n    return legend\n  }\n\n  legend.titleWidth = function(_) {\n    if (!arguments.length) return titleWidth\n    titleWidth = _\n    return legend\n  }\n\n  legend.on = function() {\n    const value = legendDispatcher.on.apply(legendDispatcher, arguments)\n    return value === legendDispatcher ? legend : value\n  }\n\n  return legend\n}\n","import helper from \"./legend\"\nimport { dispatch } from \"d3-dispatch\"\nimport { scaleLinear } from \"d3-scale\"\nimport { formatLocale, formatSpecifier } from \"d3-format\"\nimport { sum, max } from \"d3-array\"\n\nexport default function symbol() {\n  let scale = scaleLinear(),\n    shape = \"path\",\n    shapeWidth = 15,\n    shapeHeight = 15,\n    shapeRadius = 10,\n    shapePadding = 5,\n    cells = [5],\n    cellFilter,\n    labels = [],\n    classPrefix = \"\",\n    title = \"\",\n    locale = helper.d3_defaultLocale,\n    specifier = helper.d3_defaultFormatSpecifier,\n    labelAlign = \"middle\",\n    labelOffset = 10,\n    labelDelimiter = helper.d3_defaultDelimiter,\n    labelWrap,\n    orient = \"vertical\",\n    ascending = false,\n    titleWidth,\n    legendDispatcher = dispatch(\"cellover\", \"cellout\", \"cellclick\")\n\n  function legend(svg) {\n    const type = helper.d3_calcType(\n        scale,\n        ascending,\n        cells,\n        labels,\n        locale.format(specifier),\n        labelDelimiter\n      ),\n      legendG = svg.selectAll(\"g\").data([scale])\n\n    if (cellFilter) {\n      helper.d3_filterCells(type, cellFilter)\n    }\n\n    legendG\n      .enter()\n      .append(\"g\")\n      .attr(\"class\", classPrefix + \"legendCells\")\n\n    let cell = svg\n      .select(\".\" + classPrefix + \"legendCells\")\n      .selectAll(\".\" + classPrefix + \"cell\")\n      .data(type.data)\n    const cellEnter = cell\n      .enter()\n      .append(\"g\")\n      .attr(\"class\", classPrefix + \"cell\")\n    cellEnter.append(shape).attr(\"class\", classPrefix + \"swatch\")\n\n    let shapes = svg.selectAll(\"g.\" + classPrefix + \"cell \" + shape)\n\n    //add event handlers\n    helper.d3_addEvents(cellEnter, legendDispatcher)\n\n    //remove old shapes\n    cell\n      .exit()\n      .transition()\n      .style(\"opacity\", 0)\n      .remove()\n    shapes\n      .exit()\n      .transition()\n      .style(\"opacity\", 0)\n      .remove()\n    shapes = shapes.merge(shapes)\n\n    helper.d3_drawShapes(\n      shape,\n      shapes,\n      shapeHeight,\n      shapeWidth,\n      shapeRadius,\n      type.feature\n    )\n    helper.d3_addText(svg, cellEnter, type.labels, classPrefix, labelWrap)\n\n    // we need to merge the selection, otherwise changes in the legend (e.g. change of orientation) are applied only to the new cells and not the existing ones.\n    cell = cellEnter.merge(cell)\n\n    // sets placement\n    const text = cell.selectAll(\"text\"),\n      textSize = text.nodes().map(d => d.getBBox()),\n      shapeSize = shapes.nodes().map(d => d.getBBox())\n\n    const maxH = max(shapeSize, d => d.height),\n      maxW = max(shapeSize, d => d.width)\n\n    let cellTrans,\n      textTrans,\n      textAlign = labelAlign == \"start\" ? 0 : labelAlign == \"middle\" ? 0.5 : 1\n\n    //positions cells and text\n    if (orient === \"vertical\") {\n      const cellSize = textSize.map((d, i) => Math.max(maxH, d.height))\n\n      cellTrans = (d, i) => {\n        const height = sum(cellSize.slice(0, i))\n        return `translate(0, ${height + i * shapePadding} )`\n      }\n      textTrans = (d, i) => `translate( ${maxW + labelOffset},\n              ${shapeSize[i].y + shapeSize[i].height / 2 + 5})`\n    } else if (orient === \"horizontal\") {\n      cellTrans = (d, i) => `translate( ${i * (maxW + shapePadding)},0)`\n      textTrans = (d, i) => `translate( ${shapeSize[i].width * textAlign +\n        shapeSize[i].x},\n              ${maxH + labelOffset})`\n    }  else if (orient === \"horizontal-inline\"){\n      let prevCellSizes = (i) => cell.filter((d, ci) => ci < i ).nodes().reduce((acc, n, ci) => {\n          const shapeWidth = maxW + shapePadding\n          const textWidth = text.nodes()[ci].getBBox().width + labelOffset\n          return acc + shapeWidth + textWidth;\n      }, 0)\n      cellTrans = (d,i) => `translate(${prevCellSizes(i)},0)`\n      textTrans = (d,i) => `translate(${(shapeSize[i].width + shapeSize[i].x + labelOffset)}, \n        ${(shapeSize[i].y + shapeSize[i].height/2 + 5)})`\n    }\n\n    helper.d3_placement(orient, cell, cellTrans, text, textTrans, labelAlign)\n    helper.d3_title(svg, title, classPrefix, titleWidth)\n    cell.transition().style(\"opacity\", 1)\n  }\n\n  legend.scale = function(_) {\n    if (!arguments.length) return scale\n    scale = _\n    return legend\n  }\n\n  legend.cells = function(_) {\n    if (!arguments.length) return cells\n    if (_.length > 1 || _ >= 2) {\n      cells = _\n    }\n    return legend\n  }\n\n  legend.cellFilter = function(_) {\n    if (!arguments.length) return cellFilter\n    cellFilter = _\n    return legend\n  }\n\n  legend.shapePadding = function(_) {\n    if (!arguments.length) return shapePadding\n    shapePadding = +_\n    return legend\n  }\n\n  legend.labels = function(_) {\n    if (!arguments.length) return labels\n    labels = _\n    return legend\n  }\n\n  legend.labelAlign = function(_) {\n    if (!arguments.length) return labelAlign\n    if (_ == \"start\" || _ == \"end\" || _ == \"middle\") {\n      labelAlign = _\n    }\n    return legend\n  }\n\n  legend.locale = function(_) {\n    if (!arguments.length) return locale\n    locale = formatLocale(_)\n    return legend\n  }\n\n  legend.labelFormat = function(_) {\n    if (!arguments.length) return legend.locale().format(specifier)\n    specifier = formatSpecifier(_)\n    return legend\n  }\n\n  legend.labelOffset = function(_) {\n    if (!arguments.length) return labelOffset\n    labelOffset = +_\n    return legend\n  }\n\n  legend.labelDelimiter = function(_) {\n    if (!arguments.length) return labelDelimiter\n    labelDelimiter = _\n    return legend\n  }\n\n  legend.labelWrap = function(_) {\n    if (!arguments.length) return labelWrap\n    labelWrap = _\n    return legend\n  }\n\n  legend.orient = function(_) {\n    if (!arguments.length) return orient\n    _ = _.toLowerCase()\n    if (_ == \"horizontal\" || _ == \"vertical\" || _ == \"horizontal-inline\") {\n      orient = _\n    }\n    return legend\n  }\n\n  legend.ascending = function(_) {\n    if (!arguments.length) return ascending\n    ascending = !!_\n    return legend\n  }\n\n  legend.classPrefix = function(_) {\n    if (!arguments.length) return classPrefix\n    classPrefix = _\n    return legend\n  }\n\n  legend.title = function(_) {\n    if (!arguments.length) return title\n    title = _\n    return legend\n  }\n\n  legend.titleWidth = function(_) {\n    if (!arguments.length) return titleWidth\n    titleWidth = _\n    return legend\n  }\n\n  legend.on = function() {\n    const value = legendDispatcher.on.apply(legendDispatcher, arguments)\n    return value === legendDispatcher ? legend : value\n  }\n\n  return legend\n}\n","export const thresholdLabels = function({ i, genLength, generatedLabels }){\n\n  if (i === 0 ){\n    return generatedLabels[i].replace('NaN to', 'Less than')\n  } else if (i === genLength - 1) {\n    return `More than ${generatedLabels[genLength - 1].replace(' to NaN', '')}`\n  }\n  return generatedLabels[i]\n}\n\nexport default {\n  thresholdLabels\n}\n","import legendColor from './src/color'\nimport legendSize from './src/size'\nimport legendSymbol from './src/symbol'\nimport legendHelpers from './src/helpers'\n\nexport { legendColor, legendSize, legendSymbol, legendHelpers }\n\nexport default {\n  legendColor,\n  legendSize,\n  legendSymbol,\n  legendHelpers\n};\n"],"names":["d3_identity","d","d3_reverse","arr","mirror","i","l","length","d3_textWrapping","text","width","each","select","words","split","reverse","word","line","lineNumber","lineHeight","attr","dy","parseFloat","tspan","append","pop","push","join","node","getComputedTextLength","d3_mergeLabels","gen","labels","domain","range","customLabels","genLength","d3_linearLegend","scale","cells","labelFormat","data","increment","map","d3_quantLegend","labelDelimiter","invert","invertExtent","d3_ordinalLegend","d3_cellOver","cellDispatcher","obj","call","d3_cellOut","d3_cellClick","shape","shapes","shapeHeight","shapeWidth","shapeRadius","path","svg","enter","classPrefix","labelWidth","selectAll","ascending","type","ticks","cellFilter","filterCells","label","filter","dataValues","labelValues","indexOf","orient","cell","cellTrans","textTrans","labelAlign","style","dispatcher","on","title","titleWidth","titleText","cellsSvg","yOffset","nodes","getBBox","height","xOffset","x","color","scaleLinear","shapePadding","useClass","locale","helper","d3_defaultLocale","specifier","d3_defaultFormatSpecifier","labelOffset","d3_defaultDelimiter","labelWrap","legendDispatcher","dispatch","legend","d3_calcType","format","legendG","d3_filterCells","cellEnter","d3_addEvents","exit","transition","remove","merge","d3_drawShapes","d3_addText","textSize","shapeSize","feature","textAlign","cellSize","Math","max","sum","slice","y","prevCellSizes","ci","reduce","acc","n","textWidth","d3_placement","d3_title","_","arguments","formatLocale","formatSpecifier","toLowerCase","textWrap","value","apply","size","bbox","stroke","maxH","maxW","offset","symbol","thresholdLabels","generatedLabels","replace"],"mappings":"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"}